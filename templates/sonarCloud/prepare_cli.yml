parameters:
  - name: EndpointName
    type: string
    default: HMCTS_SonarCloud
  - name: Organization
    type: string
    default: hmcts
  - name: ProjectKey
    type: string
  - name: ProjectName
    type: string
    default: $(Build.Repository.Name)
  - name: ProjectVersion
    type: string
    default: $(Build.BuildNumber)
  - name: ExtraProperties
    type: string
    default: ""

steps:
  - task: SonarCloudPrepare@1
    displayName: Prepare Analysis on SonarCloud
    inputs:
      SonarCloud: ${{ parameters.EndpointName }}
      organization: ${{ parameters.Organization }}
      scannerMode: "CLI"
      configMode: "manual"
      cliProjectKey: ${{ parameters.ProjectKey }}
      cliProjectName: ${{ parameters.ProjectName }}
      cliProjectVersion: ${{ parameters.ProjectVersion }}
      cliSources: "."
      extraProperties: ${{ parameters.ExtraProperties }}
